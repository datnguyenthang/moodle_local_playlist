{"version":3,"file":"rating.min.js","sources":["../src/rating.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/templates'], function($, ajax, templates) {\n    return {\n        init: function() {\n            var rating = $('.stars');\n\n            var initialize_rating = function(rating) {\n                var current_rating = function() {\n                    return rating.find('input:checked').val() || 0;\n                };\n                var draw_rating = function(val) {\n                    rating.children('li').each(function(index) {\n                        if (index < val) {\n                            $(this).find('i').addClass('fa-star').removeClass('fa-star-o fa-star-half-o');\n                        } else {\n                            $(this).find('i').removeClass('fa-star fa-star-half-o').addClass('fa-star-o');\n                        }\n                    });\n                };\n\n                rating.children('li').mouseover(function() {\n                    var val = $(this).find('i').data('val');\n                    draw_rating(val);\n                });\n\n                rating.children('li').click(function() {\n                    var newRating = $(this).find('i').data('val');\n                    if (current_rating() == newRating) {\n                        return;\n                    } else {\n                        ajax.call([{\n                            methodname: 'local_playlist_set_rating',\n                            args: {\n                                'itemid': rating.data('itemid'),\n                                'rating': newRating\n                            }\n                        }])[0].done(function(response) {\n                            // Render the new template\n                            templates.render('local_playlist/details/_rating', { rating: response.rating })\n                                .done(function(html) {\n                                    $('#rating').html(html);\n                                    // Reinitialize rating after rendering new template\n                                    initialize_rating($('.stars'));\n                                });\n                        }).fail(function(ex) {\n                            console.error(ex);\n                        });\n                    }\n                });\n\n                // Initialize the current rating view\n                //draw_rating(current_rating());\n            };\n\n            // Initial call to set up rating interactions\n            initialize_rating(rating);\n        }\n    };\n});\n"],"names":["define","$","ajax","templates","init","rating","initialize_rating","children","mouseover","val","each","index","this","find","addClass","removeClass","draw_rating","data","click","newRating","call","methodname","args","done","response","render","html","fail","ex","console","error"],"mappings":"AAAAA,+BAAO,CAAC,SAAU,YAAa,mBAAmB,SAASC,EAAGC,KAAMC,iBACzD,CACHC,KAAM,eACEC,OAASJ,EAAE,UAEXK,kBAAoB,SAASD,QAc7BA,OAAOE,SAAS,MAAMC,WAAU,YAVd,SAASC,KACvBJ,OAAOE,SAAS,MAAMG,MAAK,SAASC,OAC5BA,MAAQF,IACRR,EAAEW,MAAMC,KAAK,KAAKC,SAAS,WAAWC,YAAY,4BAElDd,EAAEW,MAAMC,KAAK,KAAKE,YAAY,0BAA0BD,SAAS,gBAOzEE,CADUf,EAAEW,MAAMC,KAAK,KAAKI,KAAK,WAIrCZ,OAAOE,SAAS,MAAMW,OAAM,eACpBC,UAAYlB,EAAEW,MAAMC,KAAK,KAAKI,KAAK,QAlBhCZ,OAAOQ,KAAK,iBAAiBJ,OAAS,IAmBrBU,WAGpBjB,KAAKkB,KAAK,CAAC,CACPC,WAAY,4BACZC,KAAM,QACQjB,OAAOY,KAAK,iBACZE,cAEd,GAAGI,MAAK,SAASC,UAEjBrB,UAAUsB,OAAO,iCAAkC,CAAEpB,OAAQmB,SAASnB,SACjEkB,MAAK,SAASG,MACXzB,EAAE,WAAWyB,KAAKA,MAElBpB,kBAAkBL,EAAE,iBAE7B0B,MAAK,SAASC,IACbC,QAAQC,MAAMF,WAU9BtB,kBAAkBD"}